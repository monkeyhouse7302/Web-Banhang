var myvne_plugins={API3_IS_READ:0,html_no_save:'<a href="javascript:void(0);" class="save"><svg class="ic ic-save-outline"><use xlink:href="#Save-1"></use></svg>Lưu</a>',html_save:'<a href="javascript:void(0);" class="save active"><svg class="ic ic-save-outline"><use xlink:href="#Save"></use></svg>Lưu</a>',html_no_save_social:'<a href="javascript:void(0);" class="social_save flexbox"><svg class="ic ic-save"><use xlink:href="#Save"></use></svg></a>',html_save_social:'<a href="javascript:void(0);" class="social_save flexbox active"><svg class="ic ic-save"><use xlink:href="#Save"></use></svg></a>',html_no_save_social_v:'<a href="javascript:void(0);" class="circle_s flexbox luutin"><svg class="ic ic-save"><use xlink:href="#Save"></use></svg></a>',html_save_social_v:'<a href="javascript:void(0);" class="circle_s flexbox luutin active"><svg class="ic ic-save"><use xlink:href="#Save"></use></svg></a>',html_save_gocnhin:'<a title="Đã lưu" href="javascript:;"><span class="icon_savebaiviet"></span><span><i class="ic ic-bookmark" style="display: none;"></i>Đã lưu</span></a>',html_save_video_portal:'<a title="Đã lưu" href="javascript:;"><span class="icon_savebaiviet"></span><span><i class="ic ic-bookmark" style="display: none;"></i>Đã lưu</span></a>',html:{cooking:{saved:'<a href="javascript:void(0);" class="save"><svg class="icon-svg"><use xlink:href="#Saved"></use></svg>Đã lưu</a>',saved_notext:'<a href="javascript:void(0);" class="save"><svg class="icon-svg"><use xlink:href="#Saved"></use></svg></a>',no_save:'<a href="javascript:void(0);" class="save"><svg class="icon-svg"><use xlink:href="#Save"></use></svg>Lưu công thức</a>',no_save_notext:'<a href="javascript:void(0);" class="save"><svg class="icon-svg"><use xlink:href="#Save"></use></svg></a>'}},checking:0,checkingLimit:0,getCookie:function(a){for(var e=(a=this.prefix_cookie+a)+"=",t=document.cookie.split(";"),s=0;s<t.length;s++){for(var i=t[s];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return null},initButton:function(){var a=this,e=a.getCookie("myvne_user_id");$("head").append("<style type='text/css'>.lds-hourglass:after{content:\" \";display:block;border-radius:50%;width:0;height:0;margin:3px;box-sizing:border-box;border:12px solid #757575;border-color:#757575 #fff #757575 #fff;animation:lds-hourglass 5s infinite}@keyframes lds-hourglass{0%{transform:rotate(0);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}50%{transform:rotate(900deg);animation-timing-function:cubic-bezier(.215,.61,.355,1)}100%{transform:rotate(1800deg)}}</style>"),e&&!0!==isNaN(parseInt(e))||($(".social_pin .myvne_save_for_later:not([data-type])").addClass("border").html(a.html_no_save_social),$(".social-com .myvne_save_for_later:not([data-type]), .social .myvne_save_for_later:not([data-type])").addClass("border").html(a.html_no_save_social_v),$(".social-pop-right .myvne_save_for_later:not([data-type])").addClass("border").html(a.html_no_save_social_v),$(".myvne_save_for_later[data-type]").each((function(){var e=$(this).data("type"),t=$(this).data("options")||"";$(this).html(t.includes("no-text")?a.html[e].no_save_notext:a.html[e].no_save)}))),$(".footer-content .myvne_save_for_later:not([data-type])").html(a.html_no_save),$(".meta .myvne_save_for_later:not([data-type])").html(a.html_save_gocnhin),"undefined"!=typeof SITE_ID&&1003834==SITE_ID&&$(".videoportal .myvne_save_for_later:not([data-type])").html(a.html_save_video_portal)},check:function(){var a=this;myvne_users.getProfileData((function(e){if(void 0!==e&&e.user_email&&0===a.checking){a.checkingLimit=a.checkingLimit+1,a.checking=1;var t=new Array;if($(".myvne_save_for_later").each((function(a){if(!$(this).attr("data-save-added")){var e=$(this).attr("data-article-id").trim();parseInt(e)>0&&t.indexOf(e)<=-1&&t.push(e)}})),article_id=t.join(","),e.user_id&&article_id&&0==a.API3_IS_READ){var s={type:"check_user",app_id:"bd20c",user_id:e.user_id,article_id:article_id,check:"article_save"};$.ajax({type:"GET",dataType:"json",data:s,url:"//api3.vnexpress.net/api/article",success:function(e){$.each(t,(function(t,s){var i=$('.social_pin .myvne_save_for_later[data-article-id="'+s+'"]:not([data-type])'),n=$('.social-com .myvne_save_for_later[data-article-id="'+s+'"]:not([data-type]), .social .myvne_save_for_later[data-article-id="'+s+'"]:not([data-type])'),l=$('.footer-content .myvne_save_for_later[data-article-id="'+s+'"]:not([data-type])'),o=$('.box-head-tablet .myvne_save_for_later[data-article-id="'+s+'"]:not([data-type])'),r=$('.meta .myvne_save_for_later[data-article-id="'+s+'"]:not([data-type])'),v=$('.videoportal .myvne_save_for_later[data-article-id="'+s+'"]:not([data-type])'),_=$('.myvne_save_for_later[data-type][data-article-id="'+s+'"]');$('.myvne_save_for_later[data-article-id="'+s+'"]').attr("data-save-added",1),0==e.error&&1==e.data.article_save[s]?"undefined"!=typeof SITE_ID&&1003834==SITE_ID?(v.addClass("active"),$('.myvne_save_for_later[data-article-id="'+s+'"]').addClass("saved")):(i.html(a.html_save_social),n.html(a.html_save_social_v),l.html(a.html_save),o.html(a.html_save_social_v),r.addClass("active"),$('.myvne_save_for_later[data-article-id="'+s+'"]').addClass("saved"),$(_).each((function(){var e=$(this).data("type"),t=$(this).data("options")||"";$(this).addClass("saved").html(t.includes("no-text")?a.html[e].saved_notext:a.html[e].saved)}))):"undefined"!=typeof SITE_ID&&1003834==SITE_ID?v.html(a.html_save_video_portal):(i.html(a.html_no_save_social),n.html(a.html_no_save_social_v),l.html(a.html_no_save),o.html(a.html_no_save_social_v)),i.addClass("border")})),a.checking=0},error:function(e,t){a.checking=0}})}setTimeout((function(){a.check()}),6e4)}else a.checkingLimit<5&&(a.checkingLimit=a.checkingLimit+1,setTimeout((function(){a.check()}),3e3))}))},saving:0,save:function(){var a=this;a.check(),$(document).on("click",".myvne_save_for_later:not([running])",(function(){if($(this).hasClass("running"))return!1;$(this).attr("running",!0),setTimeout((function(){$(".myvne_save_for_later").removeAttr("running")}),200),a.API3_IS_READ=1;var e=$(this).attr("data-article-id"),t=$(this).attr("data-token"),s=$(this).data("type")||null,i=$(this).data("options")||"",n=$(this);"object"==typeof myvne_users&&"function"==typeof myvne_users.authentication&&0===a.saving?(myvne_users.authentication((function(l){var o="vnexpress.net";if(!l.user_email||!l.user_id)return myvne_users._html_popup_login(),!1;a.saving=1;var r={};r.user_id=l.user_id,r.article_id=e,r.token_key=t,r.user_session=l.user_session,n.hasClass("saved")||n.hasClass("active")?(r.saveaction="unsave",$.ajax({type:"POST",dataType:"json",data:r,url:"//"+o+"/api/myvnesubmit",success:function(t){0==t.error?"undefined"!=typeof SITE_ID&&1003834==SITE_ID?($('.videoportal .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').removeClass("active").html(a.html_save_video_portal),$('.myvne_save_for_later[data-article-id="'+e+'"]').removeClass("saved")):($('.social_pin .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').html(a.html_no_save_social),$('.social-com .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type]), .social .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type]), .box-head-tablet .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').html(a.html_no_save_social_v),$('.footer-content .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').html(a.html_no_save),$('.meta .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').removeClass("active").html(a.html_save_gocnhin),s&&$('.myvne_save_for_later[data-type="'+s+'"][data-article-id="'+e+'"]').html(i.includes("no-text")?a.html[s].no_save_notext:a.html[s].no_save),$('.myvne_save_for_later[data-article-id="'+e+'"]').removeClass("saved")):myvne_users._html_popup_success("Bỏ lưu bài viết không thành công, vui lòng thử lại."),a.saving=0},error:function(e,t){myvne_users._html_popup_success("Bỏ lưu bài viết không thành công, vui lòng thử lại."),a.saving=0}})):$.ajax({type:"POST",dataType:"json",data:r,url:"//"+o+"/api/myvnesubmit",success:function(t){0==t.error?("undefined"!=typeof SITE_ID&&1003834==SITE_ID?($('.videoportal .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').addClass("active").html(a.html_save_video_portal),$('.myvne_save_for_later[data-article-id="'+e+'"]').addClass("saved")):($('.social_pin .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').html(a.html_save_social),$('.social-com .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type]), .social .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type]), .box-head-tablet .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').html(a.html_save_social_v),$('.footer-content .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').html(a.html_save),$('.meta .myvne_save_for_later[data-article-id="'+e+'"]:not([data-type])').addClass("active").html(a.html_save_gocnhin),s&&$('.myvne_save_for_later[data-type="'+s+'"][data-article-id="'+e+'"]').html(i.includes("no-text")?a.html[s].saved_notext:a.html[s].saved),$('.myvne_save_for_later[data-article-id="'+e+'"]').addClass("saved")),dataLayer.push({event:"socialEvent",social_action:"save article"})):myvne_users._html_popup_success("Lưu bài viết không thành công, vui lòng thử lại."),a.saving=0},error:function(e,t){myvne_users._html_popup_success("Lưu bài viết không thành công, vui lòng thử lại."),a.saving=0}})}),"member"),setTimeout((function(){a.saving=0}),1e4)):1===a.saving&&myvne_users._html_popup_success("Sau 10 giây bạn mới có thể thực hiện hành động này.")}))},init:function(){$.when(this.initButton()).then(this.check())},run:function(){var a=this;a.initButton();var e=setInterval((function(){"undefined"!=typeof myvne_users&&(clearInterval(e),a.check(),a.save())}),1e3);setTimeout((function(){void 0===e&&null==e||clearInterval(e)}),6e4)}};